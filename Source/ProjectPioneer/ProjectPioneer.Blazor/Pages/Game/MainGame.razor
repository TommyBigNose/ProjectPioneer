@page "/Game/MainGame"
@using ProjectPioneer.Blazor.Pages.Components;

@inject ILogger<MainGame> Logger
@inject ProjectPioneer.Systems.IGame ProjectPioneerGame

<h3>Project Pioneer Main Game</h3>
<DebugTools DebugCallback="@Callback" />
<br />
<br />
<br />

<table>
    <tr>
        <td style="vertical-align: top; width: 50%">
            <HeroDisplay Hero="@ProjectPioneerGame.Hero" />
            <br />
            <br />
            <HeroStatsTotal Hero="@ProjectPioneerGame.Hero" />
            <br />
            <br />
            <InventoryDisplay @ref="InventoryComponent" InventoryCallback="@Callback" />
            <br />
            <br />
            <ShopDisplay @ref="ShopComponent" ShopCallback="@Callback" />
            <br />
            <br />
        </td>
        <td style="vertical-align: top; width: 50%">
            <QuestLogDisplay QuestLogCallback="@Callback" />
        </td>
    </tr>
</table>



@code {
    protected InventoryDisplay? InventoryComponent;
    protected ShopDisplay? ShopComponent;

    protected override void OnInitialized()
    {
        InventoryComponent = new InventoryDisplay();
        ShopComponent = new ShopDisplay();
    }

    private void Callback()
    {
        InventoryComponent?.Refresh();
        ShopComponent?.Refresh();
        base.InvokeAsync(StateHasChanged);
        Logger.LogInformation("MainGame Callback invoked");
    }
}
